# Example environment configuration for EASM
# Copy this file to .env and update with your values

# Environment Configuration
# Set to 'development' or 'production'
ENVIRONMENT=development

# Database Configuration
DATABASE_URL=postgresql://easm:changeme@localhost:5432/easm

# Security - Generate strong random API keys for production
API_KEYS=dev-key-change-me-in-production

# Authentication & SSO
# Generate a random 32+ byte string for AUTH_SECRET. Must be at least 64 chars if using Cookie Store!
AUTH_SECRET=changeme_super_secret_session_key_must_be_at_least_64_bytes_long_for_security_reasons_so_here_is_a_very_long_string_!!
AUTH_SESSION_EXPIRY_SECONDS=86400

# Google OIDC
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_DISCOVERY_URL=https://accounts.google.com
GOOGLE_REDIRECT_URI=http://localhost:3000/api/auth/callback/google
GOOGLE_ALLOWED_DOMAINS=

# Keycloak (OIDC)
KEYCLOAK_CLIENT_ID=
KEYCLOAK_CLIENT_SECRET=
KEYCLOAK_DISCOVERY_URL=
KEYCLOAK_REDIRECT_URI=http://localhost:3000/api/auth/callback/keycloak
KEYCLOAK_REALM=

# External API Keys (optional - enhances discovery capabilities)
# CERTSPOTTER_API_TOKEN=your-certspotter-token
# VIRUSTOTAL_API_KEY=your-virustotal-key
# SHODAN_API_KEY=your-shodan-key
# URLSCAN_API_KEY=your-urlscan-api-key
# OTX_API_KEY=your-otx-api-key
# CLEARBIT_API_KEY=your-clearbit-api-key
# OPENCORPORATES_API_TOKEN=your-opencorporates-token

# CORS Configuration
CORS_ALLOW_ORIGINS=http://localhost:3000,http://127.0.0.1:3000

# Application Settings
# LOG_LEVEL controls logging verbosity for both frontend and backend
# Valid values: TRACE, DEBUG, INFO, WARN, ERROR
# Note: Do NOT set RUST_LOG - it will be automatically configured from LOG_LEVEL
LOG_LEVEL=INFO
LOG_FORMAT=json

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW_SECONDS=60

# Performance Tuning
HTTP_TIMEOUT_SECONDS=8.0
TLS_TIMEOUT_SECONDS=4.0
DNS_CONCURRENCY=256
RDNS_CONCURRENCY=256
MAX_CONCURRENT_SCANS=5

# Evidence Storage
MAX_EVIDENCE_BYTES=52428800
EVIDENCE_ALLOWED_TYPES=image/png,image/jpeg,text/plain,application/pdf

# Discovery Settings  
MAX_CIDR_HOSTS=4096
MAX_DISCOVERY_DEPTH=3
SUBDOMAIN_ENUM_TIMEOUT=120.0

# OSINT Integration Toggles
# Note: The following integrations are PLANNED but NOT YET IMPLEMENTED
# Setting these to true/false currently has no effect
# Currently working integrations: Shodan, VirusTotal, CertSpotter, crt.sh (via API keys above)
ENABLE_WAYBACK=true                    # ❌ NOT IMPLEMENTED - Wayback Machine integration
ENABLE_URLSCAN=false                   # ❌ NOT IMPLEMENTED - URLScan.io integration  
ENABLE_OTX=false                       # ❌ NOT IMPLEMENTED - AlienVault OTX integration
ENABLE_DNS_RECORD_EXPANSION=true       # ⚠️  NOT CHECKED - Always enabled (planned feature)
ENABLE_WEB_CRAWL=true                  # ❌ NOT IMPLEMENTED - Web crawler for link extraction
ENABLE_CLOUD_STORAGE_DISCOVERY=true    # ❌ NOT IMPLEMENTED - S3/Azure/GCS bucket discovery
ENABLE_WIKIDATA=true                   # ❌ NOT IMPLEMENTED - Wikidata entity lookups
ENABLE_OPENCORPORATES=false            # ❌ NOT IMPLEMENTED - OpenCorporates integration

# Recursive Discovery Limits (to reduce false-positives)
# Maximum total assets to discover in a single discovery run
MAX_ASSETS_PER_DISCOVERY=5000
# Minimum confidence score (0.0-1.0) required to follow a pivot relationship
# Higher values reduce false-positives but may miss some legitimate assets
MIN_PIVOT_CONFIDENCE=0.5
# Maximum number of organizations to pivot from per domain (prevents explosion)
MAX_ORGS_PER_DOMAIN=3
# Maximum number of domains to pivot from per organization (prevents explosion)
MAX_DOMAINS_PER_ORG=20
